Hi,
just to easily explain what's going on:
i implemented this little notebook from scratch to prove an easy but really cool 
hierarchical unsupervised technique i call "collapse method".
I think that the code talks enough (is really really simple, i'll also translate
from italian to english all the comments), so nothing, enjoy it!
Frekko